package com.skplanet.jose.jws;

import com.skplanet.jose.Jose;
import com.skplanet.jose.JoseBuilders;
import com.skplanet.jose.jwa.Jwa;
import org.junit.Test;

/**
 * Created by byeongchan.park@sk.com(1000808) on 2016-01-04.
 */
public class Jws_WrongHeader_deserializeTest {
	String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJza3RtYWxsX3MwMDQiLCJhdWQiOiJodHRwczovL3BheS5zeXJ1cC5jby5rciIsInR5cCI6Impvc2UiLCJpYXQiOjE0NDcyNzMyNDIsImV4cCI6MTQ0NzI3Mzg0MiwicGF5bWVudEluZm8iOnsicHJvZHVjdFRpdGxlIjoiW-2PieydvCA17IucIOuLueydvOy2nOqzoCEgJiMzODsg7Yag7JqU7J28IOy2nOqzoCEgJiMzODsg7ISx64Ko7KeA7JetIOuLueydvCDsp4HrsLDshqEhXSDslYTsnbTtj7A1L-yVhOydtO2PsDVTL-yVhOydtO2PsDYv7JWE7J207Y-wNisv6rCV7ZmU7Jyg66asL-yVoeygleuztO2YuC_slZ7rkqTrs7TtmLgv7ZW465Oc7Y-w7LyA7J207IqkL-uplO2DiOy8gOydtOyKpC_rr7jrn6zsvIDsnbTsiqQv7ZWY7Jqw7KeVL-2MjOyKpO2FlOy8gOydtOyKpCIsImxhbmciOiJrbyIsImN1cnJlbmN5Q29kZSI6IktSVyIsInBheW1lbnRBbXQiOiI1MzIwMCIsInNoaXBwaW5nQWRkcmVzcyI6ImEyOktSfHzshJzsmrjtirnrs4Tsi5wg6rWs66Gc6rWsIOyYpOulmDLrj5kgICDrjIDsmrDtkbjrpbTsp4DsmKTslYTtjIztirggfDEwNS0xMDAyfHwiLCJpc0V4Y2hhbmdlYWJsZSI6bnVsbCwiZGVsaXZlcnlOYW1lIjoi6rO97IiZ7Z2sIiwiZGVsaXZlcnlQaG9uZU51bWJlciI6IjAxMDkxNjU4NzQzIiwiY2FyZEluZm9MaXN0IjpbeyJjYXJkQ29kZSI6IjA4IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WVk2O1lZNztZWTg7WVk5O1lZMTA7WVkxMTtZWTEyIn0seyJjYXJkQ29kZSI6IjI3IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjIwIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjIxIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjIyIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjMyIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjMzIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjM3IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6Ijk3IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjE0IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjM0IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZTjI7WU4zO1lONDtZTjU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjAyIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WVk2O1lZNztZWTg7WVk5O1lZMTA7WVkxMTtZWTEyIn0seyJjYXJkQ29kZSI6IjAxIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WVk2O1lZNztZWTg7WVk5O1lZMTA7WVkxMTtZWTEyIn0seyJjYXJkQ29kZSI6IjE3IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6Ik5OMTtOWTI7TlkzO05ZNDtOWTU7Tkg2O05ONztOTjg7Tk45O05IMTA7Tk4xMTtOTjEyIn0seyJjYXJkQ29kZSI6IjA0IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6Ik5OMTtOWTI7TlkzO05ZNDtOWTU7Tkg2O05ONztOTjg7Tk45O05IMTA7Tk4xMTtOTjEyIn0seyJjYXJkQ29kZSI6IjA3IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjE2IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6Ik5OMTtOWTI7TlkzO05ZNDtOWTU7Tlk2O05ZNztOWTg7Tlk5O05ZMTA7TlkxMTtOWTEyIn0seyJjYXJkQ29kZSI6IjExIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6Ik5OMTtOWTI7TlkzO05ZNDtOWTU7Tlk2O05ZNztOWTg7Tlk5O05ZMTA7TlkxMTtOWTEyIn0seyJjYXJkQ29kZSI6IjM1IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjA2IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6Ik5OMTtOWTI7TlkzO05ZNDtOWTU7Tkg2O05ONztOTjg7Tk45O05IMTA7Tk4xMTtOTjEyIn0seyJjYXJkQ29kZSI6IjMxIiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn0seyJjYXJkQ29kZSI6IjM2IiwibW9udGhseUluc3RhbGxtZW50SW5mbyI6IllOMTtZWTI7WVkzO1lZNDtZWTU7WU42O1lONztZTjg7WU45O1lOMTA7WU4xMTtZTjEyIn1dfSwicGF5bWVudFJlc3RyaWN0aW9ucyI6eyJjYXJkSXNzdWVyUmVnaW9uIjoiQUxMT1dFRDprb3IifSwibG9naW5JbmZvIjp7Im1jdFVzZXJJZCI6IjI3Mzg2NjkxIiwiU1NPQ3JlZGVudGlhbCI6InNlclBtanNXbUlCTlJJMlFTdXJ5U3FydkJiOEhvbmE4eWJhNVRxdXVqUGMifSwidHJhbnNhY3Rpb25JbmZvIjp7Im1jdFRyYW5zQXV0aElkIjoiMjAxNTExMTI2MjExNjI0In0sInVzZXJJbmZvTWFwcGVyIjp7Im1hcHBpbmdUeXBlIjoiQ0lfTUFQUEVEX0tFWSIsIm1hcHBpbmdWYWx1ZSI6IjI3Mzg2NjkxIn19._9J4nh7Q5bK-5-A3XtrYTqlCDsT3Myi3rwVfKHlNzgU";

	@Test
	public void test11stHmacDeserialize() {
		String actual = new Jose().configuration(
				JoseBuilders.compactDeserializationBuilder()
						.userAlgorithm(Jwa.HS256)
						.serializedSource(token)
						.key("8I9G4IPPqkik05WZj0Da3bJ5t7BEmXYj")
		).deserialization();

		System.out.println(actual);
	}
}
